!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.signalR=t()}(this,function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function r(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};var i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function s(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function a(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return s}function c(e){return this instanceof c?(this.v=e,this):new c(e)}var u=Object.freeze({__extends:function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},__assign:i,__rest:function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r},__decorate:function(e,t,r,n){var o,i=arguments.length,s=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,r,s):o(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s},__param:function(e,t){return function(r,n){t(r,n,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})},__generator:function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},__exportStar:function(e,t){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])},__values:s,__read:a,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e},__await:c,__asyncGenerator:function(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){i.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=o[e](t)).value instanceof c?Promise.resolve(r.value.v).then(u,l):p(i[0][2],r)}catch(e){p(i[0][3],e)}var r}function u(e){a("next",e)}function l(e){a("throw",e)}function p(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},__asyncDelegator:function(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){e[n]&&(t[n]=function(t){return(r=!r)?{value:c(e[n](t)),done:"return"===n}:o?o(t):t})}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):s(e)},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}}),l=(n(function(r,n){r.exports=function(){function r(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,s=void 0,a=function(e,t){g[o]=e,g[o+1]=t,2===(o+=2)&&(s?s(d):w())},c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,p="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function f(){var e=setTimeout;return function(){return e(d,1)}}var g=new Array(1e3);function d(){for(var e=0;e<o;e+=2){var t=g[e],r=g[e+1];t(r),g[e]=void 0,g[e+1]=void 0}o=0}var v,y,b,m,w=void 0;function _(e,t){var r=this,n=new this.constructor(S);void 0===n[L]&&U(n);var o=r._state;if(o){var i=arguments[o-1];a(function(){return N(o,n,i,r._result)})}else A(r,n,e,t);return n}function T(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(S);return H(t,e),t}p?w=function(){return process.nextTick(d)}:l?(y=0,b=new l(d),m=document.createTextNode(""),b.observe(m,{characterData:!0}),w=function(){m.data=y=++y%2}):h?((v=new MessageChannel).port1.onmessage=d,w=function(){return v.port2.postMessage(0)}):w=void 0===c?function(){try{var e=t,r=e("vertx");return void 0!==(i=r.runOnLoop||r.runOnContext)?function(){i(d)}:f()}catch(e){return f()}}():f();var L=Math.random().toString(36).substring(16);function S(){}var C=void 0,E=1,k=2,P=new R;function I(e){try{return e.then}catch(e){return P.error=e,P}}function M(e,t,n){t.constructor===e.constructor&&n===_&&t.constructor.resolve===T?function(e,t){t._state===E?j(e,t._result):t._state===k?x(e,t._result):A(t,void 0,function(t){return H(e,t)},function(t){return x(e,t)})}(e,t):n===P?(x(e,P.error),P.error=null):void 0===n?j(e,t):r(n)?function(e,t,r){a(function(e){var n=!1,o=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,function(r){n||(n=!0,t!==r?H(e,r):j(e,r))},function(t){n||(n=!0,x(e,t))},e._label);!n&&o&&(n=!0,x(e,o))},e)}(e,t,n):j(e,t)}function H(e,t){var r,n;e===t?x(e,new TypeError("You cannot resolve a promise with itself")):(n=typeof(r=t),null===r||"object"!==n&&"function"!==n?j(e,t):M(e,t,I(t)))}function O(e){e._onerror&&e._onerror(e._result),F(e)}function j(e,t){e._state===C&&(e._result=t,e._state=E,0!==e._subscribers.length&&a(F,e))}function x(e,t){e._state===C&&(e._state=k,e._result=t,a(O,e))}function A(e,t,r,n){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+E]=r,o[i+k]=n,0===i&&e._state&&a(F,e)}function F(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)n=t[s],o=t[s+r],n?N(r,n,o,i):o(i);e._subscribers.length=0}}function R(){this.error=null}var D=new R;function N(e,t,n,o){var i=r(n),s=void 0,a=void 0,c=void 0,u=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return D.error=e,D}}(n,o))===D?(u=!0,a=s.error,s.error=null):c=!0,t===s)return void x(t,new TypeError("A promises callback cannot return that same promise."))}else s=o,c=!0;t._state!==C||(i&&c?H(t,s):u?x(t,a):e===E?j(t,s):e===k&&x(t,s))}var q=0;function U(e){e[L]=q++,e._state=void 0,e._result=void 0,e._subscribers=[]}var W=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[L]||U(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?j(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&j(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===C&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===T){var o=I(e);if(o===_&&e._state!==C)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(r===B){var i=new r(S);M(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===C&&(this._remaining--,e===k?x(n,r):this._result[t]=r),0===this._remaining&&j(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;A(e,void 0,function(e){return r._settledAt(E,t,e)},function(e){return r._settledAt(k,t,e)})},e}(),B=function(){function e(t){this[L]=q++,this._result=this._state=void 0,this._subscribers=[],S!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){H(e,t)},function(t){x(e,t)})}catch(t){x(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},e}();return B.prototype.then=_,B.all=function(e){return new W(this,e).promise},B.race=function(e){var t=this;return n(e)?new t(function(r,n){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(r,n)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},B.resolve=T,B.reject=function(e){var t=new this(S);return x(t,e),t},B._setScheduler=function(e){s=e},B._setAsap=function(e){a=e},B._asap=a,B.polyfill=function(){var t=void 0;if(void 0!==e)t=e;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=t.Promise;if(r){var n=null;try{n=Object.prototype.toString.call(r.resolve())}catch(e){}if("[object Promise]"===n&&!r.cast)return}t.Promise=B},B.Promise=B,B.polyfill(),B}()}),n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,r){var n=this,o=this.constructor.prototype;return(n=e.call(this,t)||this).statusCode=r,n.__proto__=o,n}return u.__extends(t,e),t}(Error);t.HttpError=r;var n=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var r=this,n=this.constructor.prototype;return(r=e.call(this,t)||this).__proto__=n,r}return u.__extends(t,e),t}(Error);t.TimeoutError=n}));r(l);l.HttpError,l.TimeoutError;var p=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(t.LogLevel||(t.LogLevel={}))});r(p);p.LogLevel;var h=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t,r){this.statusCode=e,this.statusText=t,this.content=r}}();t.HttpResponse=r;var n=function(){function e(){}return e.prototype.get=function(e,t){return this.send(u.__assign({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(u.__assign({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(u.__assign({},t,{method:"DELETE",url:e}))},e}();t.HttpClient=n;var o=function(e){function t(t){var r=e.call(this)||this;return r.logger=t,r}return u.__extends(t,e),t.prototype.send=function(e){var t=this;return new Promise(function(n,o){var i=new XMLHttpRequest;i.open(e.method,e.url,!0),i.withCredentials=!0,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),e.headers&&Object.keys(e.headers).forEach(function(t){return i.setRequestHeader(t,e.headers[t])}),e.responseType&&(i.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){i.abort()}),e.timeout&&(i.timeout=e.timeout),i.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),i.status>=200&&i.status<300?n(new r(i.status,i.statusText,i.response||i.responseText)):o(new l.HttpError(i.statusText,i.status))},i.onerror=function(){t.logger.log(p.LogLevel.Warning,"Error from HTTP request. "+i.status+": "+i.statusText),o(new l.HttpError(i.statusText,i.status))},i.ontimeout=function(){t.logger.log(p.LogLevel.Warning,"Timeout from HTTP request."),o(new l.TimeoutError)},i.send(e.content||"")})},t}(n);t.DefaultHttpClient=o});r(h);h.HttpResponse,h.HttpClient,h.DefaultHttpClient;var f=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var r=t.split(e.RecordSeparator);return r.pop(),r},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}();t.TextMessageFormat=r});r(f);f.TextMessageFormat;var g=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return f.TextMessageFormat.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var t,r;if(e instanceof ArrayBuffer){var n=new Uint8Array(e);if(-1===(i=n.indexOf(f.TextMessageFormat.RecordSeparatorCode)))throw new Error("Message is incomplete.");var o=i+1;t=String.fromCharCode.apply(null,n.slice(0,o)),r=n.byteLength>o?n.slice(o).buffer:null}else{var i,s=e;if(-1===(i=s.indexOf(f.TextMessageFormat.RecordSeparator)))throw new Error("Message is incomplete.");o=i+1;t=s.substring(0,o),r=s.length>o?s.substring(o):null}var a=f.TextMessageFormat.parse(t);return[r,JSON.parse(a[0])]},e}();t.HandshakeProtocol=r});r(g);g.HandshakeProtocol;var d=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(t.MessageType||(t.MessageType={}))});r(d);d.MessageType;var v=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}();t.NullLogger=r});r(v);v.NullLogger;var y=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,r){if(!(e in t))throw new Error("Unknown "+r+" value: "+e+".")},e}();function n(e,t){var r=null;return e instanceof ArrayBuffer?(r="Binary data of length "+e.byteLength,t&&(r+=". Content: '"+o(e)+"'")):"string"==typeof e&&(r="String data of length "+e.length,t&&(r+=". Content: '"+e+"'.")),r}function o(e){var t=new Uint8Array(e),r="";return t.forEach(function(e){r+="0x"+(e<16?"0":"")+e.toString(16)+" "}),r.substr(0,r.length-1)}t.Arg=r,t.getDataDetail=n,t.formatArrayBuffer=o,t.sendMessage=function(e,t,r,o,i,s,a){return u.__awaiter(this,void 0,void 0,function(){var c,l,h,f;return u.__generator(this,function(u){switch(u.label){case 0:return[4,i()];case 1:return(l=u.sent())&&((f={}).Authorization="Bearer "+l,c=f),e.log(p.LogLevel.Trace,"("+t+" transport) sending data. "+n(s,a)+"."),[4,r.post(o,{content:s,headers:c})];case 2:return h=u.sent(),e.log(p.LogLevel.Trace,"("+t+" transport) request complete. Response status: "+h.statusCode+"."),[2]}})})},t.createLogger=function(e){return void 0===e?new a(p.LogLevel.Information):null===e?v.NullLogger.instance:e.log?e:new a(e)};var i=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,r=this.observers;t<r.length;t++){r[t].next(e)}},e.prototype.error=function(e){for(var t=0,r=this.observers;t<r.length;t++){var n=r[t];n.error&&n.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var r=t[e];r.complete&&r.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new s(this,e)},e}();t.Subject=i;var s=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}();t.SubjectSubscription=s;var a=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case p.LogLevel.Critical:case p.LogLevel.Error:console.error(p.LogLevel[e]+": "+t);break;case p.LogLevel.Warning:console.warn(p.LogLevel[e]+": "+t);break;case p.LogLevel.Information:console.info(p.LogLevel[e]+": "+t);break;default:console.log(p.LogLevel[e]+": "+t)}},e}();t.ConsoleLogger=a});r(y);y.Arg,y.getDataDetail,y.formatArrayBuffer,y.sendMessage,y.createLogger,y.Subject,y.SubjectSubscription,y.ConsoleLogger;var b=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=3e4,n=function(){function e(e,t,n){var o=this;y.Arg.isRequired(e,"connection"),y.Arg.isRequired(t,"logger"),y.Arg.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=r,this.logger=t,this.protocol=n,this.connection=e,this.handshakeProtocol=new g.HandshakeProtocol,this.connection.onreceive=function(e){return o.processIncomingData(e)},this.connection.onclose=function(e){return o.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0}return e.create=function(t,r,n){return new e(t,r,n)},e.prototype.start=function(){return u.__awaiter(this,void 0,void 0,function(){var e;return u.__generator(this,function(t){switch(t.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(p.LogLevel.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,[4,this.connection.start(this.protocol.transferFormat)];case 1:return t.sent(),this.logger.log(p.LogLevel.Debug,"Sending handshake request."),[4,this.connection.send(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return t.sent(),this.logger.log(p.LogLevel.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.configureTimeout(),[2]}})})},e.prototype.stop=function(){return this.logger.log(p.LogLevel.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.createStreamInvocation(e,r),i=new y.Subject(function(){var e=t.createCancelInvocation(o.invocationId),r=t.protocol.writeMessage(e);return delete t.callbacks[o.invocationId],t.connection.send(r)});this.callbacks[o.invocationId]=function(e,t){t?i.error(t):e.type===d.MessageType.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item)};var s=this.protocol.writeMessage(o);return this.connection.send(s).catch(function(e){i.error(e),delete t.callbacks[o.invocationId]}),i},e.prototype.send=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this.createInvocation(e,t,!0),o=this.protocol.writeMessage(n);return this.connection.send(o)},e.prototype.invoke=function(e){for(var t=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=this.createInvocation(e,r,!1);return new Promise(function(e,r){t.callbacks[o.invocationId]=function(t,n){if(n)r(n);else if(t.type===d.MessageType.Completion){var o=t;o.error?r(new Error(o.error)):e(o.result)}else r(new Error("Unexpected message type: "+t.type))};var n=t.protocol.writeMessage(o);t.connection.send(n).catch(function(e){r(e),delete t.callbacks[o.invocationId]})})},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var r=this.methods[e];if(r)if(t){var n=r.indexOf(t);-1!==n&&(r.splice(n,1),0===r.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,r=this.protocol.parseMessages(e,this.logger);t<r.length;t++){var n=r[t];switch(n.type){case d.MessageType.Invocation:this.invokeClientMethod(n);break;case d.MessageType.StreamItem:case d.MessageType.Completion:var o=this.callbacks[n.invocationId];null!=o&&(n.type===d.MessageType.Completion&&delete this.callbacks[n.invocationId],o(n));break;case d.MessageType.Ping:break;case d.MessageType.Close:this.logger.log(p.LogLevel.Information,"Close message received from server."),this.connection.stop(n.error?new Error("Server returned an error on close: "+n.error):null);break;default:this.logger.log(p.LogLevel.Warning,"Invalid message type: "+n.type)}}this.configureTimeout()},e.prototype.processHandshakeResponse=function(e){var t,r,n;try{r=(n=this.handshakeProtocol.parseHandshakeResponse(e))[0],t=n[1]}catch(e){var o="Error parsing handshake response: "+e;this.logger.log(p.LogLevel.Error,o);var i=new Error(o);throw this.connection.stop(i),i}if(t.error){o="Server returned handshake error: "+t.error;this.logger.log(p.LogLevel.Error,o),this.connection.stop(new Error(o))}else this.logger.log(p.LogLevel.Debug,"Server handshake complete.");return r},e.prototype.configureTimeout=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,r=this.methods[e.target.toLowerCase()];if(r){if(r.forEach(function(r){return r.apply(t,e.arguments)}),e.invocationId){var n="Server requested a response, which is not supported in this version of the client.";this.logger.log(p.LogLevel.Error,n),this.connection.stop(new Error(n))}}else this.logger.log(p.LogLevel.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,r=this.callbacks;this.callbacks={},Object.keys(r).forEach(function(t){(0,r[t])(void 0,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.closedCallbacks.forEach(function(r){return r.apply(t,[e])})},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,r){if(r)return{arguments:t,target:e,type:d.MessageType.Invocation};var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:d.MessageType.Invocation}},e.prototype.createStreamInvocation=function(e,t){var r=this.id;return this.id++,{arguments:t,invocationId:r.toString(),target:e,type:d.MessageType.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:d.MessageType.CancelInvocation}},e}();t.HubConnection=n});r(b);b.HubConnection;var m=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(t.HttpTransportType||(t.HttpTransportType={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(t.TransferFormat||(t.TransferFormat={}))});r(m);m.HttpTransportType,m.TransferFormat;var w=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this.isAborted=!1}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}();t.AbortController=r});r(w);w.AbortController;var _=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=5e3,n=function(){function e(e,t,n,o,i){this.httpClient=e,this.accessTokenFactory=t||function(){return null},this.logger=n,this.pollAbort=new w.AbortController,this.logMessageContent=o,this.shutdownTimeout=i||r}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return u.__awaiter(this,void 0,void 0,function(){var r,n,o,i,s;return u.__generator(this,function(a){switch(a.label){case 0:if(y.Arg.isRequired(e,"url"),y.Arg.isRequired(t,"transferFormat"),y.Arg.isIn(t,m.TransferFormat,"transferFormat"),this.url=e,this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Connecting"),t===m.TransferFormat.Binary&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return r={abortSignal:this.pollAbort.signal,headers:{},timeout:9e4},t===m.TransferFormat.Binary&&(r.responseType="arraybuffer"),[4,this.accessTokenFactory()];case 1:return n=a.sent(),this.updateHeaderToken(r,n),i=e+"&_="+Date.now(),this.logger.log(p.LogLevel.Trace,"(LongPolling transport) polling: "+i),[4,this.httpClient.get(i,r)];case 2:return 200!==(s=a.sent()).statusCode?(this.logger.log(p.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+s.statusCode),o=new l.HttpError(s.statusText,s.statusCode),this.running=!1):this.running=!0,this.poll(this.url,r,o),[2,Promise.resolve()]}})})},e.prototype.updateHeaderToken=function(e,t){t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t,r){return u.__awaiter(this,void 0,void 0,function(){var n,o,i,s;return u.__generator(this,function(a){switch(a.label){case 0:a.trys.push([0,,8,9]),a.label=1;case 1:return this.running?[4,this.accessTokenFactory()]:[3,7];case 2:n=a.sent(),this.updateHeaderToken(t,n),a.label=3;case 3:return a.trys.push([3,5,,6]),o=e+"&_="+Date.now(),this.logger.log(p.LogLevel.Trace,"(LongPolling transport) polling: "+o),[4,this.httpClient.get(o,t)];case 4:return 204===(i=a.sent()).statusCode?(this.logger.log(p.LogLevel.Information,"(LongPolling transport) Poll terminated by server"),this.running=!1):200!==i.statusCode?(this.logger.log(p.LogLevel.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode),r=new l.HttpError(i.statusText,i.statusCode),this.running=!1):i.content?(this.logger.log(p.LogLevel.Trace,"(LongPolling transport) data received. "+y.getDataDetail(i.content,this.logMessageContent)),this.onreceive&&this.onreceive(i.content)):this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return s=a.sent(),this.running?s instanceof l.TimeoutError?this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Poll timed out, reissuing."):(r=s,this.running=!1):this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Poll errored after shutdown: "+s.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.stopped=!0,this.shutdownTimer&&clearTimeout(this.shutdownTimer),this.onclose&&(this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Firing onclose event. Error: "+(r||"<undefined>")),this.onclose(r)),this.logger.log(p.LogLevel.Trace,"(LongPolling transport) Transport finished."),[7];case 9:return[2]}})})},e.prototype.send=function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){return this.running?[2,y.sendMessage(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return u.__awaiter(this,void 0,void 0,function(){var e,t,r=this;return u.__generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,,3,4]),this.running=!1,this.logger.log(p.LogLevel.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.accessTokenFactory()];case 1:return t=n.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 2:return n.sent(),this.logger.log(p.LogLevel.Trace,"(LongPolling transport) DELETE request accepted."),[3,4];case 3:return this.stopped||(this.shutdownTimer=setTimeout(function(){r.logger.log(p.LogLevel.Warning,"(LongPolling transport) server did not terminate after DELETE request, canceling poll."),r.pollAbort.abort()},this.shutdownTimeout)),[7];case 4:return[2]}})})},e}();t.LongPollingTransport=n});r(_);_.LongPollingTransport;var T=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r,n){this.httpClient=e,this.accessTokenFactory=t||function(){return null},this.logger=r,this.logMessageContent=n}return e.prototype.connect=function(e,t){return u.__awaiter(this,void 0,void 0,function(){var r,n=this;return u.__generator(this,function(o){switch(o.label){case 0:if(y.Arg.isRequired(e,"url"),y.Arg.isRequired(t,"transferFormat"),y.Arg.isIn(t,m.TransferFormat,"transferFormat"),"undefined"==typeof EventSource)throw new Error("'EventSource' is not supported in your environment.");return this.logger.log(p.LogLevel.Trace,"(SSE transport) Connecting"),[4,this.accessTokenFactory()];case 1:return(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),this.url=e,[2,new Promise(function(r,o){var i=!1;t!==m.TransferFormat.Text&&o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"));var s=new EventSource(e,{withCredentials:!0});try{s.onmessage=function(e){if(n.onreceive)try{n.logger.log(p.LogLevel.Trace,"(SSE transport) data received. "+y.getDataDetail(e.data,n.logMessageContent)+"."),n.onreceive(e.data)}catch(e){return void(n.onclose&&n.onclose(e))}},s.onerror=function(e){var t=new Error(e.message||"Error occurred");i?n.close(t):o(t)},s.onopen=function(){n.logger.log(p.LogLevel.Information,"SSE connected to "+n.url),n.eventSource=s,i=!0,r()}}catch(e){return Promise.reject(e)}})]}})})},e.prototype.send=function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){return this.eventSource?[2,y.sendMessage(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=null,this.onclose&&this.onclose(e))},e}();t.ServerSentEventsTransport=r});r(T);T.ServerSentEventsTransport;var L=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t,r){this.logger=t,this.accessTokenFactory=e||function(){return null},this.logMessageContent=r}return e.prototype.connect=function(e,t){return u.__awaiter(this,void 0,void 0,function(){var r,n=this;return u.__generator(this,function(o){switch(o.label){case 0:if(y.Arg.isRequired(e,"url"),y.Arg.isRequired(t,"transferFormat"),y.Arg.isIn(t,m.TransferFormat,"transferFormat"),"undefined"==typeof WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return this.logger.log(p.LogLevel.Trace,"(WebSockets transport) Connecting"),[4,this.accessTokenFactory()];case 1:return(r=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(r)),[2,new Promise(function(r,o){e=e.replace(/^http/,"ws");var i=new WebSocket(e);t===m.TransferFormat.Binary&&(i.binaryType="arraybuffer"),i.onopen=function(t){n.logger.log(p.LogLevel.Information,"WebSocket connected to "+e),n.webSocket=i,r()},i.onerror=function(e){o(e.error)},i.onmessage=function(e){n.logger.log(p.LogLevel.Trace,"(WebSockets transport) data received. "+y.getDataDetail(e.data,n.logMessageContent)+"."),n.onreceive&&n.onreceive(e.data)},i.onclose=function(e){n.logger.log(p.LogLevel.Trace,"(WebSockets transport) socket closed."),n.onclose&&(!1===e.wasClean||1e3!==e.code?n.onclose(new Error("Websocket closed with status code: "+e.code+" ("+e.reason+")")):n.onclose())}})]}})})},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===WebSocket.OPEN?(this.logger.log(p.LogLevel.Trace,"(WebSockets transport) sending data. "+y.getDataDetail(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.close(),this.webSocket=null),Promise.resolve()},e}();t.WebSocketTransport=r});r(L);L.WebSocketTransport;var S=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){void 0===t&&(t={}),this.features={},y.Arg.isRequired(e,"url"),this.logger=y.createLogger(t.logger),this.baseUrl=this.resolveUrl(e),(t=t||{}).accessTokenFactory=t.accessTokenFactory||function(){return null},t.logMessageContent=t.logMessageContent||!1,this.httpClient=t.httpClient||new h.DefaultHttpClient(this.logger),this.connectionState=2,this.options=t}return e.prototype.start=function(e){return e=e||m.TransferFormat.Binary,y.Arg.isIn(e,m.TransferFormat,"transferFormat"),this.logger.log(p.LogLevel.Debug,"Starting connection with transfer format '"+m.TransferFormat[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:this.connectionState=2,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?(this.stopError=e,[4,this.transport.stop()]):[3,6];case 5:t.sent(),this.transport=null,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return u.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i,s,a,c=this;return u.__generator(this,function(l){switch(l.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,l.label=1;case 1:return l.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==m.HttpTransportType.WebSockets?[3,3]:(this.transport=this.constructTransport(m.HttpTransportType.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return l.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:r=null,n=0,o=function(){var e;return u.__generator(this,function(o){switch(o.label){case 0:return[4,i.getNegotiationResponse(t)];case 1:return r=o.sent(),2===i.connectionState?[2,{value:void 0}]:(r.url&&(t=r.url),r.accessToken&&(e=r.accessToken,i.accessTokenFactory=function(){return e}),n++,[2])}})},i=this,l.label=6;case 6:return[5,o()];case 7:if("object"==typeof(s=l.sent()))return[2,s.value];l.label=8;case 8:if(r.url&&n<100)return[3,6];l.label=9;case 9:if(100===n&&r.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,r,e)];case 10:l.sent(),l.label=11;case 11:return this.transport instanceof _.LongPollingTransport&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return c.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw a=l.sent(),this.logger.log(p.LogLevel.Error,"Failed to start the connection: "+a),this.connectionState=2,this.transport=null,a;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return u.__awaiter(this,void 0,void 0,function(){var t,r,n,o,i,s;return u.__generator(this,function(a){switch(a.label){case 0:return[4,this.accessTokenFactory()];case 1:(t=a.sent())&&((s={}).Authorization="Bearer "+t,r=s),n=this.resolveNegotiateUrl(e),this.logger.log(p.LogLevel.Debug,"Sending negotiation request: "+n),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.httpClient.post(n,{content:"",headers:r})];case 3:if(200!==(o=a.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+o.statusCode);return[2,JSON.parse(o.content)];case 4:throw i=a.sent(),this.logger.log(p.LogLevel.Error,"Failed to complete negotiation with the server: "+i),i;case 5:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return e+(-1===e.indexOf("?")?"?":"&")+"id="+t},e.prototype.createTransport=function(e,t,r,n){return u.__awaiter(this,void 0,void 0,function(){var o,i,s,a,c,l,h;return u.__generator(this,function(u){switch(u.label){case 0:return o=this.createConnectUrl(e,r.connectionId),this.isITransport(t)?(this.logger.log(p.LogLevel.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(o,n)]):[3,2];case 1:return u.sent(),this.changeState(0,1),[2];case 2:i=r.availableTransports,s=0,a=i,u.label=3;case 3:return s<a.length?(c=a[s],this.connectionState=0,"number"!=typeof(l=this.resolveTransport(c,t,n))?[3,8]:(this.transport=this.constructTransport(l),null!==r.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:r=u.sent(),o=this.createConnectUrl(e,r.connectionId),u.label=5;case 5:return u.trys.push([5,7,,8]),[4,this.transport.connect(o,n)];case 6:return u.sent(),this.changeState(0,1),[2];case 7:return h=u.sent(),this.logger.log(p.LogLevel.Error,"Failed to start the transport '"+m.HttpTransportType[l]+"': "+h),this.connectionState=2,r.connectionId=null,[3,8];case 8:return s++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case m.HttpTransportType.WebSockets:return new L.WebSocketTransport(this.accessTokenFactory,this.logger,this.options.logMessageContent);case m.HttpTransportType.ServerSentEvents:return new T.ServerSentEventsTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent);case m.HttpTransportType.LongPolling:return new _.LongPollingTransport(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,r){var n=m.HttpTransportType[e.transport];if(null==n)this.logger.log(p.LogLevel.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var o=e.transferFormats.map(function(e){return m.TransferFormat[e]});if(function(e,t){return!e||0!=(t&e)}(t,n))if(o.indexOf(r)>=0){if(!(n===m.HttpTransportType.WebSockets&&"undefined"==typeof WebSocket||n===m.HttpTransportType.ServerSentEvents&&"undefined"==typeof EventSource))return this.logger.log(p.LogLevel.Debug,"Selecting transport '"+m.HttpTransportType[n]+"'"),n;this.logger.log(p.LogLevel.Debug,"Skipping transport '"+m.HttpTransportType[n]+"' because it is not supported in your environment.'")}else this.logger.log(p.LogLevel.Debug,"Skipping transport '"+m.HttpTransportType[n]+"' because it does not support the requested transfer format '"+m.TransferFormat[r]+"'.");else this.logger.log(p.LogLevel.Debug,"Skipping transport '"+m.HttpTransportType[n]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){return u.__awaiter(this,void 0,void 0,function(){return u.__generator(this,function(t){return this.transport=null,(e=this.stopError||e)?this.logger.log(p.LogLevel.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(p.LogLevel.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e),[2]})})},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(p.LogLevel.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),r=e.substring(0,-1===t?e.length:t);return"/"!==r[r.length-1]&&(r+="/"),r+="negotiate",r+=-1===t?"":e.substring(t)},e}();t.HttpConnection=r});r(S);S.HttpConnection;var C=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="json",n=function(){function e(){this.name=r,this.version=1,this.transferFormat=m.TransferFormat.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=v.NullLogger.instance);for(var r=[],n=0,o=f.TextMessageFormat.parse(e);n<o.length;n++){var i=o[n],s=JSON.parse(i);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case d.MessageType.Invocation:this.isInvocationMessage(s);break;case d.MessageType.StreamItem:this.isStreamItemMessage(s);break;case d.MessageType.Completion:this.isCompletionMessage(s);break;case d.MessageType.Ping:case d.MessageType.Close:break;default:t.log(p.LogLevel.Information,"Unknown message type '"+s.type+"' ignored.");continue}r.push(s)}return r},e.prototype.writeMessage=function(e){return f.TextMessageFormat.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}();t.JsonHubProtocol=n});r(C);C.JsonHubProtocol;var E=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.configureLogging=function(e){return y.Arg.isRequired(e,"logging"),void 0!==e.log?this.logger=e:this.logger=new y.ConsoleLogger(e),this},e.prototype.withUrl=function(e,t){return y.Arg.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return y.Arg.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new S.HttpConnection(this.url,e);return b.HubConnection.create(t,this.logger||v.NullLogger.instance,this.protocol||new C.JsonHubProtocol)},e}();t.HubConnectionBuilder=r});r(E);E.HubConnectionBuilder;var k=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION="0.0.0-DEV_BUILD",t.HttpError=l.HttpError,t.TimeoutError=l.TimeoutError,t.DefaultHttpClient=h.DefaultHttpClient,t.HttpClient=h.HttpClient,t.HttpResponse=h.HttpResponse,t.HubConnection=b.HubConnection,t.HubConnectionBuilder=E.HubConnectionBuilder,t.MessageType=d.MessageType,t.LogLevel=p.LogLevel,t.HttpTransportType=m.HttpTransportType,t.TransferFormat=m.TransferFormat,t.NullLogger=v.NullLogger,t.JsonHubProtocol=C.JsonHubProtocol});r(k);k.VERSION,k.HttpError,k.TimeoutError,k.DefaultHttpClient,k.HttpClient,k.HttpResponse,k.HubConnection,k.HubConnectionBuilder,k.MessageType,k.LogLevel,k.HttpTransportType,k.TransferFormat,k.NullLogger,k.JsonHubProtocol;return r(n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),Uint8Array.prototype.indexOf||Object.defineProperty(Uint8Array.prototype,"indexOf",{value:Array.prototype.indexOf,writable:!0}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0}),Uint8Array.prototype.forEach||Object.defineProperty(Uint8Array.prototype,"forEach",{value:Array.prototype.forEach,writable:!0}),u.__exportStar(k,t)}))});